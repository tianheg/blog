<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="{{ .Site.Language.Lang }}">

    <title>
      {{- block "title" . -}}
        {{ if .IsPage }}{{ .Title }} - {{ .Site.Title }}{{ else }}{{ .Site.Title }}{{ end }}
      {{- end -}}
    </title>

    {{ partial "head.html" . }}

  </head>

  {{ $csClass := "colorscheme-light" }}
  {{ if eq .Site.Params.colorScheme "dark" }}
    {{ $csClass = "colorscheme-dark" }}
  {{ else if eq .Site.Params.colorScheme "auto" }}
    {{ $csClass = "colorscheme-auto" }}
  {{ end }}
  <body class="{{ $csClass }}">
    {{ partial "float" . }}
    <main class="wrapper">
      {{ partial "header.html" . }}

      <div class="content">
        {{ block "content" . }}{{ end }}
      </div>

      {{ partial "footer.html" . }}
    </main>

    {{ if not .Site.Params.hideColorSchemeToggle }}
      {{ if .Site.IsServer }}
        {{ $script := resources.Get "js/dark-mode.js" }}
        <script src="{{ $script.RelPermalink }}"></script>
      {{ else }}
        {{ $script := resources.Get "js/dark-mode.js" | minify | fingerprint }}
        <script src="{{ $script.RelPermalink }}"></script>
      {{ end }}
    {{ end }}

    {{ range .Site.Params.customJS }}
      <script src="{{ . | relURL }}"></script>
    {{ end }}

    {{ template "_internal/google_analytics.html" . }}
    
    {{ if and .Site.Params.googleTagManager .Site.Params.googleTagManager.id }}
      {{- partial "analytics/googletagmanager" . -}}
    {{ end }}
    
    {{ if and .Site.Params.cloudflare .Site.Params.cloudflare.token }}
      {{- partial "analytics/cloudflare" . -}}
    {{ end }}

    {{ if and .Site.Params.baidutongji .Site.Params.baidutongji.id }}
      {{- partial "analytics/baidutongji" . -}}
    {{ end }}

    {{ if and .Site.Params.enableServiceWorker (eq hugo.Environment "production") }}
        {{- $sw := resources.Get "js/sw.js" -}}
        {{- $dummy := "" | resources.FromString "dummy.js" -}}
        {{- $url := (slice $sw $dummy | resources.Concat "sw.js").RelPermalink -}}

        <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function() {
                    navigator.serviceWorker.register('{{ $url }}');
                });
            }
        </script>
    {{ end }}
    <script>
      console.info("\n%c üéâ Âó®~ ÊÉ≥ÁúãÊ∫ê‰ª£Á†ÅÔºü %c \nGitHub‰ªìÂ∫ì: https://github.com/tianheg/blog \n%cÂ≠¶‰π†ÊäÄÊúØ%c„ÄÅ%cÁÉ≠Áà±ÁîüÊ¥ª%c„ÄÇ",
      "color: #fff; padding: 5px 0; background: #29c75f; margin: 1em 0;",
      "display: block;margin-left: 0.5em; margin: 1em 0;",
      "color:#E24432; font-size: 16px; margin: 1em 0;",
      "color:#666666; font-size: 16px; margin: 1em 0;",
      "color:#0E70ED; font-size: 16px; margin: 1em 0;",
      "color:#666666; font-size: 16px; margin: 1em 0;");
  </script>
  </body>

</html>
