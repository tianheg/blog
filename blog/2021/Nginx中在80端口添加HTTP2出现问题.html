<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-11-28 Sun 08:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<p>
<del>+</del> date = '2021-11-03T09:05:48+08:00' title = 'Nginx 中在 80 端口添加
HTTP/2 出现问题' tags = ['Nginx', 'HTTP/2'] slug =
'nginx-error-with-80-http2' <del>+</del>
</p>

<p>
承接上篇文章<a href="file:///posts/nginx-http2/">通过 Nginx 让网站支持
HTTP/2</a>，当我完成文章中的操作时，有一次我好奇网站 HTTP
是否能够自动跳转到 HTTPS，于是我输入
<code>http://blog.yidajiabei.xyz/=，意外发生了------没有跳转到
HTTPS，还下载了一个名字为 =download</code> 且文件类型为
=application/octet-stream=。
</p>

<p>
我很意外，思考这是为什么。把这个问题记下来，过了几个小时，我从网络中找到答案：HTTP2
不需要加密<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>，当然这只是肤浅的说法，一定还有深层次的理解。
</p>

<p>
通过这篇文章<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>，我学到一条检查网站是否支持 HTTP/2 的命令：
</p>

<pre class="example" id="org5333797">
$ curl -I -k --http2 https://blog.yidajiabei.xyz/
HTTP/2 200 
server: nginx/1.18.0 (Ubuntu)
date: Wed, 03 Nov 2021 00:37:29 GMT
content-type: text/html
content-length: 5254
last-modified: Tue, 02 Nov 2021 23:37:46 GMT
etag: "6181cbca-1486"
accept-ranges: bytes
</pre>

<p>
在这篇文章中，我找到了 Nginx 配置 HTTP/2 的方法：
</p>

<pre class="example" id="orgfa932cb">
server {
    listen 443 ssl http2 default_server;
    ssl_certificate    /path/to/server.cert;
    ssl_certificate_key /path/to/server.key;
    # ...
    # Copy from the HTTP server
    # ...
}
</pre>

<p>
根据这一配置，再联系到 HTTP/2 不需要加密，那么是不是不能在 80 端口配置
HTTP2 呢？也就是说，以下配置会造成无法由 HTTP 跳转到 HTTPS：
</p>

<pre class="example" id="orgad2ebfa">
server {
    listen 80 http2;
    # ...
}
</pre>

<p>
当这一切都被修正时，HTTP 就能够跳转到 HTTPS 了。
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
<a href="https://http2.github.io/faq/#does-http2-require-encryption">https://http2.github.io/faq/#does-http2-require-encryption</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
<a href="https://dassur.ma/things/h2setup/">https://dassur.ma/things/h2setup/</a>
</p></div></div>


</div>
</div></div>
</body>
</html>